\chapter{Extracció de referències}
\label{chapter:refextraction}

Un cop hem aconseguit trobar pàgines que contenen informació de l'article pel qual volem generar la referència bibliogràfica, és moment d'extreure aquesta informació i formatar-la. En aquest capítol tractarem dels problemes que hem trobat a l'hora d'extreure la in

\section{\textit{Wrappers}}
En el nostre context, anomenarem \textit{wrapper} a una classe que implementa una sèrie de mètodes establerts i que, a partir d'un text o document d'entrada, permet extreure'n certa informació. Podem imaginar-ho com un filtre que només ens deixa veure una part del document que ens interessa.
\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.8]{figures/wrapper_sample.pdf}
\caption{Exemple de la funció d'un \textit{wrapper}}
\label{fig:wrapper-desc}
\end{center}
\end{figure}

A la nostra aplicació tindrem els dos tipus de \textit{wrapper} que es descriuen a continuació.

%%%%% FIELD WRAPPERS %%%%
\subsection{\textit{Field Wrappers}}
\label{chapter:refextraction:section:fieldwrappers}
S'encarreguen d'extreure únicament un dels camps de la referència cada vegada. Se'n necessita un per cadascun dels camps que volem extreure per cada biblioteca d'articles que vulguem suportar.

\paragraph{}
Internament, aquests tipus de \textit{wrappers} consisteixen en un llistat de regles que cal aplicar en un ordre determinat i que, si tot va bé, dónen com a resultat el valor que volem aconseguir. 

\paragraph{}
En un principi vam començar a definir aquestes regles manualment, mirant de fer-les prou generals com per poder-les reutilitzar per múltiples biblioteques, però de seguida vam adonar-nos que aquesta és una tasca que consumeix molt temps. A més, els resultats es veuen afectats per qualsevol canvi en l'estructura de les pàgines font. Per tant, vam decidir centrar els recursos en trobar la manera de generar aquests \textit{wrappers} de forma automàtica. Com que aquesta és una de les parts més interessants del projecte, li hem dedicat el capítol \ref{chapter:wrapperinduction} sencer. 

\paragraph{}
Pel que fa al procés d'extracció, donat el resultat web d'un article mirem si disposem de \textit{wrappers} a la base de dades de l'aplicació i, en cas afirmatiu, obtenim aquells amb la puntuació més elevada. Per cadascun d'aquests \textit{wrappers} provarem d'extreure el camp de la pàgina. Si veiem el resultat obtingut amb algun d'ells es considera vàlid, pararem l'extracció i passarem al següent camp.

\paragraph{}
Com es pot deduir, no serà necessari tenir \textit{wrappers} que funcionin en tots els casos sinó que només caldrà tenir-ne uns quants que ho facin en un percentatge prou elevat. D'aquesta manera, en aquelles situacions on la informació està estructurada diferent, també podrem obtenir resultats.

%%%% REFERENCE WRAPPERS %%%%
\subsection{\textit{Reference Wrappers}}
\label{refextraction:reference-wrappers}
Aquest tipus de \textit{wrappers} extreuen el text corresponent a una referència sencera. El gran avantatge que tenen és que habitualment permeten extreure molta més informació i amb una confiança molt més gran. Ara per ara, el sistema només suporta referències \BibTeX{}, però es podria ampliar amb qualsevol altre format.

\paragraph{}
El principal problema és que moltes vegades el text de les referències no es troba a la mateixa pàgina retornada pels cercadors, sinó que cal seguir algun enllaç o realitzar altres accions abans d'obtenir-les. Això complica força la generació automàtica. A més, si tenim en compte el fet que d'aquests \textit{wrappers} només en necessitem un per cada biblioteca, fa que automatitzar-ho no ens aporti un benefici gaire gran. Per tant, hem decidit implementar-los manualment.

\paragraph{}
En algunes ocasions, aplicant una mica d'enginyeria inversa podem aconseguir alguna drecera per arribar a les referències a partir de les direccions retornades pels cercadors. Un dels casos més senzills és el de la biblioteca digital \textit{ScientificCommons} on per obtenir el codi \BibTeX{} només hem de canviar l'adreça retornada pel cercador:
\begin{center}
\begin{lstlisting}[caption={Adreça d'un artice de \textit{ScientificCommons}}, nolol=true]
Canviem...
http://en.scientificcommons.org/32119993
per...
http://en.scientificcommons.org/export/bibtex/32119993
\end{lstlisting}
\end{center}

Un altre inconvenient d'aquest tipus de \textit{wrappers} és que hi ha moltes biblioteques digitals que no ofereixen les referències en \BibTeX{} sinó en altres formats com ara \textit{RIS}, \textit{MODS}, etc. Els formats que s'ofereixen depenen força del camp de coneixement en què s'especialitza la biblioteca.


\section{Validació de referències}
\subsubsection{\textit{Parsing} de referències}
Per poder validar les referències obtingudes a partir dels \textit{reference wrappers}, és necessari analitzar-les sintàcticament per tal de poder validar cadascun dels camps. Per aquest motiu, l'aplicació disposa d'un \textit{parser} de referències en format \BibTeX{}.


\section{Format de referències}
Com a detalls de la implementació, només comentar que tindrem un jerarquia de classes anomenades \textit{generadors} (\texttt{Generator}) que, guiades per una classe formatadora (\texttt{Formatter}) permetran generar les referències en el format desitjat.

\section{Emmagatzematge}
\label{chapger:refextraction:storage}
Totes les referències extretes s'emmagatzemen a la base de dades de l'aplicació per poder-les utilitzar en un futur tant per 

A part de la referència en si, també es desa la consulta extreta del PDF per cercar a Internet i el resultat de la pàgina de la qual s'ha extret la referència.
